â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ  ğŸ¯ RETELL WEBHOOK - QUICK REFERENCE CARD                     â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

ğŸ“‹ BEFORE DEPLOYMENT
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ï¸âƒ£  Setup MongoDB Indexes:
    cd server && npm run setup-db

2ï¸âƒ£  Test Webhook Locally:
    cd server && npm run test-webhook

3ï¸âƒ£  Verify Environment Variables:
    âœ“ MONGODB_URI
    âœ“ JWT_SECRET
    âœ“ CLIENT_URL


ğŸš€ DEPLOYMENT COMMANDS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Push to GitHub (Render auto-deploys):
git add .
git commit -m "Add Retell webhook system"
git push origin main

Check Render Logs:
âœ… MongoDB Connected
âœ… Call indexes synchronized
ğŸš€ Server running


ğŸ”— API ENDPOINTS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

POST /webhook/retell
    â†’ Receives Retell AI call data
    â†’ Public (no auth)
    â†’ Returns 200 always (prevents retry storms)

GET /api/my-calls
    â†’ Returns authenticated user's calls
    â†’ Requires JWT token
    â†’ Sorted by latest first


ğŸ“± FRONTEND ROUTE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

/my-calls
    â†’ Shows call history table
    â†’ Stats: total calls, duration, recent
    â†’ Click row to view full transcript


ğŸ§ª TEST COMMANDS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Test Webhook (Local):
curl -X POST http://localhost:3001/webhook/retell \
  -H "Content-Type: application/json" \
  -d '{"callId":"test_123","phoneNumber":"+14095551234","summary":"Test"}'

Test Webhook (Production):
curl -X POST https://your-app.onrender.com/webhook/retell \
  -H "Content-Type: application/json" \
  -d '{"callId":"prod_123","phoneNumber":"+14095551234","summary":"Test"}'

Check MongoDB:
mongosh "your-connection-string"
use aivors
db.calls.find().pretty()


âš™ï¸ NPM SCRIPTS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

npm start          â†’ Start server
npm run setup-db   â†’ Setup MongoDB indexes
npm run test-webhook â†’ Test webhook locally
npm run dev        â†’ Development mode (nodemon)


ğŸ”§ RETELL AI CONFIGURATION
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Webhook URL:
https://your-backend.onrender.com/webhook/retell

Events to Subscribe:
âœ“ call_completed
âœ“ call_analyzed (optional)


ğŸ—„ï¸ MONGODB ATLAS SETUP
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Network Access:
Add IP: 0.0.0.0/0

Database User:
Role: readWrite

Connection String:
mongodb+srv://<user>:<pass>@cluster.mongodb.net/<db>


ğŸ“Š MONGODB INDEXES (Auto-Created)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ“ callId (unique)           â†’ Prevent duplicates
âœ“ email                     â†’ Fast user lookups
âœ“ createdAt                 â†’ Sort by date
âœ“ { email, createdAt }      â†’ Optimized queries


ğŸ› TROUBLESHOOTING
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

"No user found for phone"
â†’ Add phone to user in MongoDB:
  db.users.updateOne(
    { email: "user@example.com" },
    { $set: { "business.phoneNumber": "+14095551234" } }
  )

"Network timeout"
â†’ Add 0.0.0.0/0 to MongoDB Atlas Network Access

"Calls not showing"
â†’ Check email matches between user and calls:
  db.calls.find({ email: "actual-user@example.com" })


ğŸ“ FILES CREATED
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Backend:
âœ“ server/routes/retellWebhook.js    (Webhook handler)
âœ“ server/routes/myCalls.js          (API endpoint)
âœ“ server/models/Call.js             (MongoDB schema)
âœ“ server/setup-mongodb.js           (DB setup script)
âœ“ server/test-retell-webhook.js     (Test script)
âœ“ server/config/db.js               (Auto-index sync)

Frontend:
âœ“ src/pages/MyCallsPage.tsx         (React component)
âœ“ src/App.tsx                       (Route added)

Documentation:
âœ“ RETELL-WEBHOOK-SETUP.md           (Full implementation)
âœ“ docs/MONGODB-DEPLOYMENT-GUIDE.md  (MongoDB guide)
âœ“ DEPLOY-CHECKLIST.md               (Quick deploy)
âœ“ QUICK-REFERENCE.txt               (This file)


âœ… DEPLOYMENT READINESS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ“ MongoDB schema with email as primary identifier
âœ“ Webhook endpoint with phone-to-email resolution
âœ“ Idempotency (duplicate prevention)
âœ“ Authenticated API for user calls
âœ“ React frontend with table and modal
âœ“ Automatic index creation on startup
âœ“ Test scripts included
âœ“ Production error handling
âœ“ CSRF exclusion for webhook
âœ“ Comprehensive documentation


ğŸ‰ READY TO DEPLOY!
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. npm run setup-db          (Setup MongoDB)
2. npm run test-webhook       (Test locally)
3. git push origin main       (Deploy to Render)
4. Configure Retell webhook   (Add webhook URL)
5. Visit /my-calls            (View calls)


ğŸ“ SUPPORT
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Email: info@restaurant-ai.com
Phone: (409) 960-2907
